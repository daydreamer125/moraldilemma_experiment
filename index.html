<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>My experiment</title>

    <!-- JsPsych -->
    <script src="https://unpkg.com/jspsych@7.2.1"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@1.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-fullscreen@1.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-external-html@1.1.0"></script>
    <link href="https://unpkg.com/jspsych@7.2.1/css/jspsych.css" rel="stylesheet" type="text/css"/>
    <style>
        .jspsych-display-element {
            font-size: 20px;
        }

        .jspsych-content {
            max-width: 80%;
        }
    </style>

</head>
<body>
</body>
<script>
    /* initialize jsPsych */
    const jsPsych = initJsPsych();

    /* create timeline */
    const timeline = [];

    /*  const check_consent = function () {
          if (document.getElementById('consent_checkbox').checked) {
              return true;
          } else {
              alert("If you wish to participate, you must check the box next to the statement 'I agree to participate in this study.'");
              return false;
          }
      };
      /* Check Consent */
    /*   const consent = {
           type: jsPsychExternalHtml,
           url: lang + ".html",
           cont_btn: "start",
           check_fn: check_consent
       };
       timeline.push(consent)
       */

    const lang = jsPsych.randomization.sampleWithoutReplacement(["de", "en"], 1)


    const enter_fullscreen = {
        type: jsPsychFullscreen,
        fullscreen_mode: true,
    }
    // timeline.push(enter_fullscreen)


    /*  Instructions  */

    const instructions = {
        type: jsPsychExternalHtml,
        url: "content/" + lang + "_1.html",
        cont_btn: "start",
    };
    timeline.push(instructions)


    const check_answer = function () {
        if (document.getElementById('yes_checkbox').checked ^ document.getElementById('no_checkbox').checked) {
            return true;
        } else {
            alert("Please select exactly one answer.'");
            return false;
        }
    };


    const act = jsPsych.randomization.sampleWithoutReplacement(["action", "inaction", "action", "inaction", "action", "inaction", "action", "inaction", "action", "inaction"], 9)
    const dilemma = jsPsych.randomization.sampleWithoutReplacement(["orphanage", "ebola", "foxhole", "crevasse", "transplant", "nobelprize"], 6)
    const involv = jsPsych.randomization.sampleWithoutReplacement(["low_involv_", "high_involv_", "low_involv_", "high_involv_", "high_involv_", "low_involv_", "low_involv_", "high_involv_", "low_involv_", "high_involv_"], 9)
    const cong = jsPsych.randomization.sampleWithoutReplacement(["cong_", "incong_", "cong_", "incong_", "cong_", "incong_", "cong_", "incong_", "cong_", "incong_"], 9)

    for (let i = 0; i < 9; i++) {
        let trial = {
            type: jsPsychExternalHtml,
            url: "content/" + lang + "/" + dilemma[i] + "/self_rel_pres_" + involv[i] + cong[i] + act[i] + ".html",
            check_fn: check_answer,
            cont_btn: "next",
            /* save_trial_parameters: {(document.getElementByID('yes_checkbox').checked)}, */
        };

        timeline.push(trial)
    }

    /* start the experiment */
    jsPsych.run(timeline);

    console.log(jsPsych.data.get())

</script>
</html>